<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Your Personal Blueprint | COACH CHRIS</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #000;
            color: #fff;
            /* Simple background pattern */
            background-image: radial-gradient(#222 1px, transparent 1px);
            background-size: 40px 40px;
        }
        .quiz-container {
            max-width: 650px;
            min-height: 550px;
            background-color: #fff;
            color: #000;
            border: 4px solid #fff;
            /* Bold shadow for a physical/printed look */
            box-shadow: 10px 10px 0 0 #333; 
            transition: all 0.3s ease-in-out;
        }
        .option-button {
            border: 2px solid #000;
            background-color: #fff;
            color: #000;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: -0.02em;
            transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            /* Initial flat shadow */
            box-shadow: 0 0 0 0 #000;
        }
        .option-button:hover:not(.selected) {
            /* Lift effect */
            transform: translate(-2px, -2px);
            box-shadow: 4px 4px 0 0 #000;
            background-color: #f3f4f6;
        }
        .selected {
            background-color: #000 !important;
            color: #fff !important;
            border-color: #000 !important;
            /* Pop out effect for selected option, with green highlight */
            transform: translate(-2px, -2px);
            box-shadow: 4px 4px 0 0 #22c55e !important; 
        }
        .action-button {
            /* Green-500 */
            background-color: #22c55e;
            color: #000;
            border: 2px solid #000;
            font-weight: 900;
            text-transform: uppercase;
            /* White shadow for contrast */
            box-shadow: 4px 4px 0 0 #fff; 
            transition: all 0.2s;
        }
        .action-button:hover:not(:disabled) {
            transform: translate(-2px, -2px);
            box-shadow: 6px 6px 0 0 #fff;
        }
        .action-button:disabled {
            background-color: #e5e7eb;
            color: #9ca3af;
            border-color: #d1d5db;
            box-shadow: none;
            cursor: not-allowed;
        }
        .progress-container {
            background-color: #000; 
            height: 12px;
        }
        .progress-bar-fill {
            background-color: #22c55e;
            transition: width 0.3s ease-in-out;
        }
        /* Entrance animation for quiz questions */
        .animate-in {
            animation: slideUpFade 0.4s ease-out;
        }
        @keyframes slideUpFade {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .custom-input {
            border: 2px solid #000;
            border-radius: 0.5rem;
            transition: all 0.2s;
        }
        .custom-input:focus {
            outline: none;
            box-shadow: 4px 4px 0 0 #22c55e;
            border-color: #000;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4 sm:p-6">

    <!-- Main Quiz Container -->
    <div id="quiz-app" class="quiz-container w-full rounded-2xl p-6 md:p-10 relative overflow-hidden">
        
        <!-- Decoration: Green accent line top -->
        <div class="absolute top-0 left-0 w-full h-2 bg-green-500"></div>

        <!-- BRANDING BLOCK -->
        <div class="mb-6 leading-tight animate-in">
            <h1 class="text-4xl sm:text-5xl font-black text-black uppercase tracking-tighter">
                COACH CHRIS
            </h1>
            <p class="text-lg font-extrabold uppercase text-neutral-600">
                CIRCULAR ROOTS COACHING
            </p>
            <p class="text-base font-extrabold uppercase text-neutral-700">
                TRAIN UNCNVNTNL
            </p>
        </div>

        <!-- Main Quiz Title -->
        <h2 class="text-3xl sm:text-4xl font-black text-black mb-4 uppercase italic tracking-tighter">
            YOUR PERSONAL BLUEPRINT
        </h2>
        
        <!-- Progress Bar -->
        <div class="mb-8">
            <div class="flex items-center space-x-3">
                <!-- Progress Label -->
                <p id="progress-text-label" class="text-sm font-black uppercase tracking-widest text-black whitespace-nowrap">
                    QUESTION 1 OF 6
                </p>
                <!-- Progress Bar Container -->
                <div class="progress-container h-3 flex-grow rounded-full overflow-hidden">
                    <div id="progress-bar-fill" class="progress-bar-fill h-full" style="width: 0%;"></div>
                </div>
                <!-- Percentage -->
                <p id="progress-percent" class="text-sm font-black text-black whitespace-nowrap">
                    0%
                </p>
            </div>
        </div>

        <!-- Dynamic Content Area -->
        <div id="content-area">
            <!-- Quiz steps will be rendered here -->
            <div class="text-center font-bold animate-pulse">LOADING...</div>
        </div>

    </div>
    
    <!-- Footer Tag -->
    <div class="mt-8 text-neutral-500 text-xs font-bold uppercase tracking-widest">
        TRAIN UNCNVNTNL
    </div>

    <script>
        // --- FORM SUBMIT CONFIGURATION ---
        const COACH_EMAIL = "circularrootscoaching@gmail.com"; 

        // --- QUIZ DATA ---
        const quizData = [
            {
                id: 1,
                question: "What is your #1 primary fitness goal right now?",
                key: "1_Goal",
                options: [
                    { text: "Fat Loss / Body Transformation", score: 30 },
                    { text: "Build Muscle & Increase Strength", score: 20 },
                    { text: "Improve Endurance & Stamina", score: 10 },
                    { text: "General Health & Consistency", score: 5 },
                ]
            },
            {
                id: 2,
                question: "How many days per week can you realistically commit?",
                key: "2_Commitment",
                options: [
                    { text: "5 or more days", score: 30 },
                    { text: "3 - 4 days", score: 20 },
                    { text: "1 - 2 days", score: 10 },
                    { text: "Not sure / Just starting", score: 5 },
                ]
            },
            {
                id: 3,
                question: "What is your biggest barrier to success?",
                key: "3_Barrier",
                options: [
                    { text: "Lack of a Specific Program", score: 5 },
                    { text: "Consistency & Accountability", score: 20 },
                    { text: "Nutrition & Diet Strategy", score: 30 },
                    { text: "Motivation & Time", score: 10 },
                ]
            },
            {
                id: 4,
                question: "What level of support do you need?",
                key: "4_Support",
                options: [
                    { text: "Self-paced Program Template", score: 5 },
                    { text: "Weekly Check-ins & Messaging", score: 20 },
                    { text: "Full 1:1 Coaching (High Accountability)", score: 30 },
                    { text: "Group / Community Environment", score: 10 },
                ]
            },
            {
                id: 5,
                question: "Do you have any injuries or medical considerations?",
                key: "5_Injuries",
                options: [
                    { text: "Yes, I need tailored modifications.", score: 30 },
                    { text: "Minor aches, nothing serious.", score: 20 },
                    { text: "No, generally injury-free.", score: 10 },
                    { text: "I'm not sure.", score: 5 },
                ]
            },
            {
                id: 6,
                question: "What is your budget for coaching?",
                key: "6_Budget",
                options: [
                    { text: "High (Ready for Premium 1:1)", score: 30 },
                    { text: "Medium (Solid Subscription Model)", score: 20 },
                    { text: "Low (Budget-Friendly Option)", score: 10 },
                    { text: "Results are the priority", score: 25 },
                ]
            }
        ];

        let currentStep = 0;
        let userAnswers = []; 
        let selectedOption = null;
        let selectedOptionText = null;

        // --- RECOMMENDATION LOGIC ---
        /**
         * Calculates the total score from the accumulated user answers.
         * @param {Array<Object>} answers - The array of user answers with scores.
         * @returns {number} The total score.
         */
        function calculateTotalScore(answers) {
            return answers.reduce((sum, answer) => sum + answer.score, 0);
        }

        /**
         * Determines the coaching recommendation based on the total score.
         * @param {number} score - The total quiz score.
         * @returns {Object} The recommendation details.
         */
        function getRecommendation(score) {
            if (score >= 140) {
                return {
                    title: "1-1 ONLINE COACHING",
                    description: "Your goals require maximum accountability and highly specific programming. This is the premium, fully-tailored blueprint designed to adapt to your life.",
                    service: "1-1 Online Coaching",
                    accentColor: "text-green-600"
                };
            } else if (score >= 85) {
                return {
                    title: "FITTER STRONGER BETTER SUBSCRIPTION",
                    description: "You have clear goals and moderate commitment. This model provides structure, personalized check-ins, and the perfect blend of accountability and flexibility.",
                    service: "Fitter Stronger Better Subscription",
                     accentColor: "text-blue-600"
                };
            } else {
                return {
                    title: "ONLINE PROGRAM LIBRARY",
                    description: "You are seeking foundational guidance. Get instant access to professionally designed, self-paced training plans you can execute on your own schedule.",
                    service: "Online Program Library",
                     accentColor: "text-gray-800"
                };
            }
        }
        
        /**
         * Generates the personalized Blueprint content for the email body using the collected answers.
         * @param {Object} recommendation - The final service recommendation.
         * @returns {string} The formatted text content of the Blueprint.
         */
        function generateBlueprintContent(recommendation) {
            const totalScore = calculateTotalScore(userAnswers);
            
            // Convert answers array to a key-value object for easy lookup
            const answersMap = userAnswers.reduce((map, answer) => {
                map[answer.key] = answer.answer;
                return map;
            }, {});

            // Use string interpolation to build the detailed Blueprint text
            const blueprintContent = `
=============================================
YOUR PERSONAL BLUEPRINT: THE COACH CHRIS ROADMAP
=============================================

Blueprint Score: ${totalScore}
Best Match: ${recommendation.title}

---

SECTION 1: YOUR ANALYSIS SUMMARY
----------------------------------
This analysis confirms that your current fitness journey requires a specialized approach tailored to your profile:

* Primary Goal (#1): ${answersMap['1_Goal']}
* Time Commitment (#2): You can realistically commit ${answersMap['2_Commitment']}.
* Biggest Barrier (#3): ${answersMap['3_Barrier']}
* Support Need (#4): You indicated a need for ${answersMap['4_Support']}.
* Injury Status (#5): ${answersMap['5_Injuries']}
* Budget (#6): ${answersMap['6_Budget']}

---

SECTION 2: YOUR RECOMMENDED PATH
----------------------------------
-> SERVICE: ${recommendation.title}
-> WHY: ${recommendation.description}

This service is uniquely positioned to solve your primary hurdle, ${answersMap['3_Barrier']}, by providing a system designed for maximum results.

---

SECTION 3: NEXT STEPS
----------------------------------
Click here to schedule your first 15-minute onboarding call with Coach Chris and lock in your new training path:
[INSERT YOUR CALENDLY/BOOKING LINK HERE]

We look forward to training with you.
- The Circular Roots Coaching Team
            `;

            return blueprintContent.trim();
        }

        // --- UI RENDER FUNCTIONS ---
        const contentArea = document.getElementById('content-area');
        const progressBarFill = document.getElementById('progress-bar-fill');
        const progressTextLabel = document.getElementById('progress-text-label'); 
        const progressPercent = document.getElementById('progress-percent'); 

        /**
         * Updates the progress bar and text label.
         */
        function updateProgress() {
            const totalQuestions = quizData.length;
            const displayStep = currentStep === totalQuestions ? totalQuestions : currentStep + 1;
            // Calculate progress based on completed steps (currentStep)
            const progress = (currentStep / totalQuestions) * 100;
            const percentageDisplay = Math.round(progress);

            progressBarFill.style.width = `${progress}%`;
            progressPercent.textContent = `${percentageDisplay}%`;

            if (currentStep < totalQuestions) {
                progressTextLabel.textContent = `QUESTION ${displayStep} OF ${totalQuestions}`;
            } else {
                 // Set to 100% on results screen
                 progressBarFill.style.width = `100%`;
                 progressTextLabel.textContent = `ANALYSIS COMPLETE`;
            }
        }

        /**
         * Renders the current quiz question and options.
         */
        function renderQuestion() {
            if (currentStep >= quizData.length) {
                renderResultsScreen();
                return;
            }

            const stepData = quizData[currentStep];
            selectedOption = null;
            selectedOptionText = null;
            
            // Clear content and add the new question/options block
            contentArea.innerHTML = ''; 

            const questionBlock = document.createElement('div');
            questionBlock.className = 'animate-in';
            questionBlock.innerHTML = `
                <h2 class="text-2xl font-black uppercase leading-tight mb-8">${stepData.question}</h2>
                <div id="options-container" class="space-y-4">
                    <!-- Options appended here -->
                </div>
                <button id="next-button" disabled class="action-button mt-10 w-full p-4 text-xl rounded-lg">
                    CONTINUE
                </button>
            `;
            contentArea.appendChild(questionBlock);

            const optionsContainer = document.getElementById('options-container');
            const nextButton = document.getElementById('next-button');

            // Create and attach option buttons
            stepData.options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option.text;
                button.className = 'option-button w-full text-left p-5 rounded-lg text-lg';
                // Attach score and text data for easy retrieval
                button.setAttribute('data-score', option.score);
                button.setAttribute('data-text', option.text);
                
                button.addEventListener('click', () => {
                    // Deselect all other buttons
                    document.querySelectorAll('.option-button').forEach(btn => btn.classList.remove('selected'));
                    // Select the current button
                    button.classList.add('selected');
                    // Store the selection
                    selectedOption = option.score;
                    selectedOptionText = option.text;
                    // Enable the continue button
                    nextButton.disabled = false;
                });
                optionsContainer.appendChild(button);
            });
            
            nextButton.addEventListener('click', handleNext);
            updateProgress();
        }
        
        /**
         * Renders the final results and the lead capture form.
         */
        function renderResultsScreen() {
            currentStep = quizData.length;
            updateProgress();
            
            const totalScore = calculateTotalScore(userAnswers);
            const recommendation = getRecommendation(totalScore);

            contentArea.innerHTML = `
                <div class="text-center animate-in">
                    <!-- Checkmark Icon -->
                    <div class="inline-block p-3 rounded-full border-4 border-black mb-6">
                        <svg class="h-10 w-10 text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                        </svg>
                    </div>
                    <h2 class="text-lg font-bold text-gray-500 uppercase tracking-widest mb-2">Based on your answers:</h2>
                    <p class="text-3xl sm:text-4xl font-black uppercase italic mb-6 leading-none ${recommendation.accentColor}">${recommendation.title}</p>
                    <p class="text-lg font-medium text-gray-700 mb-10 leading-relaxed">${recommendation.description}</p>
                </div>
                
                <!-- Lead Capture Form -->
                <div id="lead-form-container" class="animate-in bg-gray-50 border-2 border-black p-6 rounded-xl relative">
                    <!-- Decorative Green Square -->
                    <div class="absolute -top-3 -right-3 w-8 h-8 bg-green-500 border-2 border-black"></div>
                    
                    <h4 class="text-xl font-black uppercase mb-2">Get Your Roadmap</h4>
                    <p class="text-sm font-medium text-gray-600 mb-6">Enter your details to receive your customized strategy.</p>
                    
                    <form id="lead-capture-form" action="https://formsubmit.co/${COACH_EMAIL}" method="POST" class="space-y-4">
                        
                        <!-- FormSubmit Required Fields -->
                        <input type="hidden" name="_captcha" value="false">
                        <input type="hidden" name="_subject" id="form-subject" value="NEW BLUEPRINT LEAD: ${recommendation.title}">
                        
                        <!-- Redirect the user back to the quiz page after successful submission -->
                        <input type="hidden" name="_next" id="redirect-url" value="">

                        <div>
                            <label for="name" class="block text-xs font-bold uppercase mb-1">Full Name</label>
                            <input type="text" id="name" name="name" required class="custom-input block w-full p-3 bg-white" placeholder="JANE DOE">
                        </div>
                        
                        <div>
                            <label for="email" class="block text-xs font-bold uppercase mb-1">Email Address</label>
                            <!-- IMPORTANT: FormSubmit uses the 'email' field to set the Reply-To address. -->
                            <input type="email" id="email" name="email" required class="custom-input block w-full p-3 bg-white" placeholder="HELLO@EXAMPLE.COM">
                            
                            <!-- Hidden field to send a CC copy to the client's email -->
                            <input type="hidden" name="_cc" id="cc-email-field" value="">
                        </div>
                        
                        <!-- Hidden fields for quiz answers will be added dynamically in JS -->
                        <div id="hidden-fields-container"></div>
                        
                        <button type="submit" id="submit-button" class="action-button w-full py-4 mt-2 rounded-lg text-lg">
                            SEND MY ROADMAP
                        </button>
                    </form>

                    <!-- Message box for success/error (non-alert implementation) -->
                    <p id="message-box" class="mt-4 p-3 rounded-lg border-2 border-black text-center font-bold hidden"></p>
                </div>
            `;
            
            // Attach form submission handler
            document.getElementById('lead-capture-form').addEventListener('submit', handleFormSubmit);

            // Set the redirect URL dynamically to the current page URL
            document.getElementById('redirect-url').value = window.location.href + '?status=success';
        }

        // --- EVENT HANDLERS (UPDATED) ---
        /**
         * Handles moving to the next question and stores the answer.
         */
        function handleNext() {
            if (selectedOption !== null && selectedOptionText !== null) {
                // Store the full answer object
                userAnswers.push({
                    question: quizData[currentStep].question,
                    answer: selectedOptionText,
                    score: selectedOption,
                    key: quizData[currentStep].key
                });
                currentStep++;
                renderQuestion();
            }
        }

        /**
         * Prepares the form for submission, including dynamic hidden fields for the blueprint email.
         * @param {Event} event - The form submission event.
         */
        function handleFormSubmit(event) {
            const form = event.target;
            const submitButton = document.getElementById('submit-button');
            const hiddenFieldsContainer = document.getElementById('hidden-fields-container');
            
            // Set sending state immediately before the browser starts processing the submission
            submitButton.disabled = true;
            submitButton.textContent = 'SENDING...';

            // --- 1. Gather Dynamic Data ---
            const recommendation = getRecommendation(calculateTotalScore(userAnswers));
            const clientEmail = form.elements['email'].value;
            const blueprintContent = generateBlueprintContent(recommendation);
            
            // --- 2. Add Hidden Fields for FormSubmit ---
            
            // Clear previous hidden fields
            hiddenFieldsContainer.innerHTML = '';
            
            // A. The full personalized Blueprint for the Coach & Client CC
            // Note: encodeURIComponent ensures the multi-line text is transmitted correctly.
            hiddenFieldsContainer.innerHTML += `<input type="hidden" name="Client_Blueprint" value="${encodeURIComponent(blueprintContent)}">`;
            
            // B. Static recommendation/score data
            hiddenFieldsContainer.innerHTML += `<input type="hidden" name="Score" value="${calculateTotalScore(userAnswers)}">`;
            hiddenFieldsContainer.innerHTML += `<input type="hidden" name="Recommendation" value="${recommendation.title}">`;
            
            // C. All individual quiz answers (for detailed tracking in the FormSubmit spreadsheet)
            userAnswers.forEach(answer => {
                // Ensure field names are clean
                const fieldName = answer.key.replace(/[^a-zA-Z0-9_]/g, '');
                hiddenFieldsContainer.innerHTML += `<input type="hidden" name="${fieldName}" value="${answer.answer}">`;
            });

            // D. Set the CC field to send a copy to the client (this is the client's 'roadmap' email)
            document.getElementById('cc-email-field').value = clientEmail;

            // E. Update Subject before submission
            document.getElementById('form-subject').value = `NEW BLUEPRINT LEAD: ${recommendation.title} (${clientEmail})`;
            
            // The form will now submit naturally, redirecting to the URL set in _next, where the success message will be shown.
        }
        
        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            if (progressTextLabel && progressPercent) {
                updateProgress(); 
            }
            renderQuestion();

            // Check if submission was successful after FormSubmit redirects back
            const urlParams = new URLSearchParams(window.location.search);
            const messageBox = document.getElementById('message-box');

            if (urlParams.get('status') === 'success') {
                // Remove the quiz UI elements to show only the success state
                contentArea.innerHTML = '';
                
                // Construct a custom success message display
                const successDiv = document.createElement('div');
                successDiv.className = 'text-center animate-in p-8 bg-green-50 border-2 border-green-600 rounded-xl';
                successDiv.innerHTML = `
                    <div class="inline-block p-3 rounded-full border-4 border-green-600 bg-green-200 mb-4">
                        <svg class="h-10 w-10 text-green-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                        </svg>
                    </div>
                    <h2 class="text-3xl font-black uppercase leading-tight text-green-700 mb-3">BLUEPRINT SENT!</h2>
                    <p class="text-lg font-medium text-gray-700 leading-relaxed">
                        Your personalized blueprint is on its way. Check your inbox (and spam folder) for your customized strategy roadmap.
                    </p>
                    <button onclick="window.location.href=window.location.href.split('?')[0]" class="action-button mt-6 p-3 text-base rounded-lg shadow-green-500/50">
                        RESTART QUIZ
                    </button>
                `;
                contentArea.appendChild(successDiv);
                
                updateProgress();

                // Clear the status parameter from the URL to avoid showing the message on refresh
                if (window.history.replaceState) {
                    const cleanUrl = window.location.href.split('?')[0];
                    window.history.replaceState({}, document.title, cleanUrl);
                }
            }
        });
    </script>
</body>
</html>

